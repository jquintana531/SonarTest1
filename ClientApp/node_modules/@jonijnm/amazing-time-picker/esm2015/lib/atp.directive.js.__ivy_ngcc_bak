import { Directive, EventEmitter, HostListener, Output, ViewContainerRef } from '@angular/core';
import { NG_VALUE_ACCESSOR } from '@angular/forms';
import { AmazingTimePickerService } from './amazing-time-picker.service';
export class AtpDirective {
    constructor(viewContainerRef, atp) {
        this.viewContainerRef = viewContainerRef;
        this.atp = atp;
        this.myClick = new EventEmitter();
        this.onChange = (x) => {
        };
        this.elementRef = this.viewContainerRef.element;
    }
    onClick(e) {
        const ele = this.viewContainerRef.element.nativeElement;
        const time = ele.value;
        const theme = ele.getAttribute('theme');
        const start = ele.getAttribute('start');
        const end = ele.getAttribute('end');
        const locale = ele.getAttribute('locale') || 'en';
        const changeToMinutes = ele.getAttribute('changeToMinutes') === 'true';
        const animation = ele.getAttribute('animation');
        const preference = ele.getAttribute('preference') || null;
        const onlyHour = ele.getAttribute('onlyHour') === 'true';
        const onlyMinute = ele.getAttribute('onlyMinute') === 'true';
        const onlyAM = ele.getAttribute('onlyAM') === 'true';
        const onlyPM = ele.getAttribute('onlyPM') === 'true';
        let arrowStyle = ele.getAttribute('arrowStyle');
        arrowStyle = (arrowStyle) ? JSON.parse(arrowStyle.replace(new RegExp('\'', 'g'), '"')) : '';
        const timePickerFunction = this.atp.open({
            time,
            theme,
            rangeTime: { start, end },
            'arrowStyle': arrowStyle,
            locale,
            changeToMinutes,
            animation,
            onlyHour,
            onlyMinute,
            onlyAM,
            onlyPM,
            preference
        });
        timePickerFunction.afterClose().subscribe(retTime => {
            this.writeValue(retTime); // update the native element
            this.onChange(retTime); // update the form value (if there's a form)
        });
    }
    onInput(e) {
        this.onChange(e.srcElement.value);
    }
    writeValue(value) {
        if (this.elementRef) {
            this.elementRef.nativeElement.value = value;
        }
    }
    registerOnChange(fn) {
        this.onChange = fn;
    }
    registerOnTouched(fn) {
    }
}
AtpDirective.decorators = [
    { type: Directive, args: [{
                selector: 'input[atp-time-picker]',
                providers: [
                    {
                        provide: NG_VALUE_ACCESSOR,
                        useExisting: AtpDirective,
                        multi: true
                    }
                ]
            },] }
];
AtpDirective.ctorParameters = () => [
    { type: ViewContainerRef },
    { type: AmazingTimePickerService }
];
AtpDirective.propDecorators = {
    myClick: [{ type: Output }],
    onClick: [{ type: HostListener, args: ['click', ['$event'],] }],
    onInput: [{ type: HostListener, args: ['input', ['$event'],] }]
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXRwLmRpcmVjdGl2ZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3Byb2plY3RzL2FtYXppbmctdGltZS1waWNrZXIvc3JjL2xpYi9hdHAuZGlyZWN0aXZlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBQyxTQUFTLEVBQWMsWUFBWSxFQUFFLFlBQVksRUFBRSxNQUFNLEVBQUUsZ0JBQWdCLEVBQUMsTUFBTSxlQUFlLENBQUM7QUFDMUcsT0FBTyxFQUF1QixpQkFBaUIsRUFBQyxNQUFNLGdCQUFnQixDQUFDO0FBQ3ZFLE9BQU8sRUFBQyx3QkFBd0IsRUFBQyxNQUFNLCtCQUErQixDQUFDO0FBWXZFLE1BQU0sT0FBTyxZQUFZO0lBUXZCLFlBQ1MsZ0JBQWtDLEVBQ2pDLEdBQTZCO1FBRDlCLHFCQUFnQixHQUFoQixnQkFBZ0IsQ0FBa0I7UUFDakMsUUFBRyxHQUFILEdBQUcsQ0FBMEI7UUFSN0IsWUFBTyxHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7UUFHL0IsYUFBUSxHQUFHLENBQUMsQ0FBTSxFQUFRLEVBQUU7UUFDcEMsQ0FBQyxDQUFDO1FBTUEsSUFBSSxDQUFDLFVBQVUsR0FBRyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsT0FBTyxDQUFDO0lBQ2xELENBQUM7SUFHRCxPQUFPLENBQUMsQ0FBQztRQUNQLE1BQU0sR0FBRyxHQUFHLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxPQUFPLENBQUMsYUFBYSxDQUFDO1FBQ3hELE1BQU0sSUFBSSxHQUFHLEdBQUcsQ0FBQyxLQUFLLENBQUM7UUFDdkIsTUFBTSxLQUFLLEdBQUcsR0FBRyxDQUFDLFlBQVksQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUN4QyxNQUFNLEtBQUssR0FBRyxHQUFHLENBQUMsWUFBWSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ3hDLE1BQU0sR0FBRyxHQUFHLEdBQUcsQ0FBQyxZQUFZLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDcEMsTUFBTSxN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dEVtaXR0ZXIsIEhvc3RMaXN0ZW5lciwgT3V0cHV0LCBWaWV3Q29udGFpbmVyUmVmfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7Q29udHJvbFZhbHVlQWNjZXNzb3IsIE5HX1ZBTFVFX0FDQ0VTU09SfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XG5pbXBvcnQge0FtYXppbmdUaW1lUGlja2VyU2VydmljZX0gZnJvbSAnLi9hbWF6aW5nLXRpbWUtcGlja2VyLnNlcnZpY2UnO1xuXG5ARGlyZWN0aXZlKHtcbiAgc2VsZWN0b3I6ICdpbnB1dFthdHAtdGltZS1waWNrZXJdJyxcbiAgcHJvdmlkZXJzOiBbXG4gICAge1xuICAgICAgcHJvdmlkZTogTkdfVkFMVUVfQUNDRVNTT1IsXG4gICAgICB1c2VFeGlzdGluZzogQXRwRGlyZWN0aXZlLFxuICAgICAgbXVsdGk6IHRydWVcbiAgICB9XG4gIF1cbn0pXG5leHBvcnQgY2xhc3MgQXRwRGlyZWN0aXZlIGltcGxlbWVudHMgQ29udHJvbFZhbHVlQWNjZXNzb3Ige1xuXG4gIEBPdXRwdXQoKSBteUNsaWNrID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuXG4gIHByaXZhdGUgZWxlbWVudFJlZjogRWxlbWVudFJlZjtcbiAgcHJpdmF0ZSBvbkNoYW5nZSA9ICh4OiBhbnkpOiB2b2lkID0+IHtcbiAgfTtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBwdWJsaWMgdmlld0NvbnRhaW5lclJlZjogVmlld0NvbnRhaW5lclJlZixcbiAgICBwcml2YXRlIGF0cDogQW1hemluZ1RpbWVQaWNrZXJTZXJ2aWNlXG4gICkge1xuICAgIHRoaXMuZWxlbWVudFJlZiA9IHRoaXMudmlld0NvbnRhaW5lclJlZi5lbGVtZW50O1xuICB9XG5cbiAgQEhvc3RMaXN0ZW5lcignY2xpY2snLCBbJyRldmVudCddKVxuICBvbkNsaWNrKGUpIHtcbiAgICBjb25zdCBlbGUgPSB0aGlzLnZpZXdDb250YWluZXJSZWYuZWxlbWVudC5uYXRpdmVFbGVtZW50O1xuICAgIGNvbnN0IHRpbWUgPSBlbGUudmFsdWU7XG4gICAgY29uc3QgdGhlbWUgPSBlbGUuZ2V0QXR0cmlidXRlKCd0aGVtZScpO1xuICAgIGNvbnN0IHN0YXJ0ID0gZWxlLmdldEF0dHJpYnV0ZSgnc3RhcnQnKTtcbiAgICBjb25zdCBlbmQgPSBlbGUuZ2V0QXR0cmlidXRlKCdlbmQnKTtcbiAgICBjb25zdCBsb2NhbGUgPSBlbGUuZ2V0QXR0cmlidXRlKCdsb2NhbGUnKSB8fCAnZW4nO1xuICAgIGNvbnN0IGNoYW5nZVRvTWludXRlcyA9IGVsZS5nZXRBdHRyaWJ1dGUoJ2NoYW5nZVRvTWludXRlcycpID09PSAndHJ1ZSc7XG4gICAgY29uc3QgYW5pbWF0aW9uID0gZWxlLmdldEF0dHJpYnV0ZSgnYW5pbWF0aW9uJyk7XG4gICAgY29uc3QgcHJlZmVyZW5jZSA9IGVsZS5nZXRBdHRyaWJ1dGUoJ3ByZWZlcmVuY2UnKSB8fCBudWxsO1xuICAgIGNvbnN0IG9ubHlIb3VyID0gZWxlLmdldEF0dHJpYnV0ZSgnb25seUhvdXInKSA9PT0gJ3RydWUnO1xuICAgIGNvbnN0IG9ubHlNaW51dGUgPSBlbGUuZ2V0QXR0cmlidXRlKCdvbmx5TWludXRlJykgPT09ICd0cnVlJztcbiAgICBjb25zdCBvbmx5QU0gPSBlbGUuZ2V0QXR0cmlidXRlKCdvbmx5QU0nKSA9PT0gJ3RydWUnO1xuICAgIGNvbnN0IG9ubHlQTSA9IGVsZS5nZXRBdHRyaWJ1dGUoJ29ubHlQTScpID09PSAndHJ1ZSc7XG4gICAgbGV0IGFycm93U3R5bGUgPSBlbGUuZ2V0QXR0cmlidXRlKCdhcnJvd1N0eWxlJyk7XG4gICAgYXJyb3dTdHlsZSA9IChhcnJvd1N0eWxlKSA/IEpTT04ucGFyc2UoYXJyb3dTdHlsZS5yZXBsYWNlKG5ldyBSZWdFeHAoJ1xcJycsICdnJyksICdcIicpKSA6ICcnO1xuICAgIGNvbnN0IHRpbWVQaWNrZXJGdW5jdGlvbiA9IHRoaXMuYXRwLm9wZW4oe1xuICAgICAgdGltZSxcbiAgICAgIHRoZW1lLFxuICAgICAgcmFuZ2VUaW1lOiB7c3RhcnQsIGVuZH0sXG4gICAgICAnYXJyb3dTdHlsZSc6IGFycm93U3R5bGUsXG4gICAgICBsb2NhbGUsXG4gICAgICBjaGFuZ2VUb01pbnV0ZXMsXG4gICAgICBhbmltYXRpb24sXG4gICAgICBvbmx5SG91cixcbiAgICAgIG9ubHlNaW51dGUsXG4gICAgICBvbmx5QU0sXG4gICAgICBvbmx5UE0sXG4gICAgICBwcmVmZXJlbmNlXG4gICAgfSk7XG5cbiAgICB0aW1lUGlja2VyRnVuY3Rpb24uYWZ0ZXJDbG9zZSgpLnN1YnNjcmliZShyZXRUaW1lID0+IHtcbiAgICAgIHRoaXMud3JpdGVWYWx1ZShyZXRUaW1lKTsgLy8gdXBkYXRlIHRoZSBuYXRpdmUgZWxlbWVudFxuICAgICAgdGhpcy5vbkNoYW5nZShyZXRUaW1lKTsgLy8gdXBkYXRlIHRoZSBmb3JtIHZhbHVlIChpZiB0aGVyZSdzIGEgZm9ybSlcbiAgICB9KTtcbiAgfVxuXG4gIEBIb3N0TGlzdGVuZXIoJ2lucHV0JywgWyckZXZlbnQnXSlcbiAgb25JbnB1dChlOiBhbnkpIHtcbiAgICB0aGlzLm9uQ2hhbmdlKGUuc3JjRWxlbWVudC52YWx1ZSk7XG4gIH1cblxuICB3cml0ZVZhbHVlKHZhbHVlOiBhbnkpIHtcbiAgICBpZiAodGhpcy5lbGVtZW50UmVmKSB7XG4gICAgICB0aGlzLmVsZW1lbnRSZWYubmF0aXZlRWxlbWVudC52YWx1ZSA9IHZhbHVlO1xuICAgIH1cbiAgfVxuXG4gIHJlZ2lzdGVyT25DaGFuZ2UoZm46IGFueSkge1xuICAgIHRoaXMub25DaGFuZ2UgPSBmbjtcbiAgfVxuXG4gIHJlZ2lzdGVyT25Ub3VjaGVkKGZuKSB7XG4gIH1cbn1cbiJdfQ==